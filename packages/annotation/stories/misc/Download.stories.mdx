import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs'
import { Chart, Typography } from '@chsk/core'
import { Bar, Bars } from '@chsk/band'
import { Download, BoxedLabel } from '../../src'
import { barProps } from '../decorators'

<Meta title="Addons/Annotation/Misc/Download" />

# Download

export const Template = args => <Download {...args} />

`Download` provides a click-able object that triggers a download of chart content into a file.

<ArgsTable of={Download} />

## Data download

Set prop `variant` to `'data'` to fetch the raw data associated with a view (in `json` format).

The example below uses a simple `Bar` view; click the text above the bars to download the raw data for the bars.

<Canvas>
    <Story name="data download">
        <Chart
            id={'downloadData'}
            size={[400, 300]}
            padding={[40, 40, 20, 40]}
            style={{ display: 'inline-block' }}
        >
            <Bar {...barProps}>
                <Bars />
                <Download variant={'data'} filename={'example.json'}>
                    <BoxedLabel
                        position={[0, -24]}
                        size={[200, 24]}
                        anchor={[0, 0]}
                        style={{ cursor: 'pointer' }}
                        boxStyle={{ fill: '#f2f2f2', strokeWidth: 1 }}
                        children={'click this box to download data'}
                    />
                </Download>
            </Bar>
        </Chart>
    </Story>
</Canvas>

## Image download

Set prop `variant` to `'image'` to fetch an image of the entire chart (in `svg` format).

<Canvas>
    <Story name="image download">
        <Chart
            id={'downloadImage'}
            size={[400, 300]}
            padding={[40, 40, 20, 40]}
            style={{ display: 'inline-block' }}
        >
            <Bar {...barProps}>
                <Bars />
                <Download variant={'image'} filename={'example.svg'}>
                    <BoxedLabel
                        position={[0, -24]}
                        size={[200, 24]}
                        anchor={[0, 0]}
                        style={{ cursor: 'pointer' }}
                        boxStyle={{ fill: '#f2f2f2', strokeWidth: 1 }}
                        children={'click this box to download image'}
                    />
                </Download>
            </Bar>
        </Chart>
    </Story>
</Canvas>

Note that the downloaded image may appear slightly different, when previewed offline, than in the browser.
This is usually because of discrepancies in font faces.
In particular, the generic font face 'sans-serif' may be interpreted differently in different contexts.
To maximize consistency, use a specific font face that is available across all target platforms.

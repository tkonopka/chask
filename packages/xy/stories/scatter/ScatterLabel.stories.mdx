import { ArgsTable, Canvas, Meta, Source, Story } from '@storybook/addon-docs'
import { Chart, Axis } from '@chsk/core'
import { Scatter, ScatterPoints, ScatterCurve, ScatterLabel } from '../../src'
import { ChartScatterQuadraticDecorator } from './decorators'
import { generateScatterSeries } from './generators'
import data from './dataPolynomials.json'

# ScatterLabel

<Meta title="Addons/XY/Scatter/ScatterLabel" />
export const Template = args => <ScatterLabel {...args} />

`ScatterLabel` draws a label on a scatter plot.

<ArgsTable of={ScatterLabel} />

export const dataWithNoise = [
    generateScatterSeries(
        'A',
        Array(60)
            .fill(0)
            .map(v => 1 + 10 * Math.random()),
        x => 0.3 * x + Math.random() * 3
    ),
]

## Position

The position of the label is specified with prop `position` and an accompanying `positionUnit`.

The position can be specified as a single value. In this case, the value is interpreted as the x coordinate.
`ScatterLabel` retrieves a data point nearby that x position, and determines the vertical location for the label.

<Canvas>
    <Story name="points">
        <Chart size={[400, 300]} padding={[40, 40, 60, 60]} style={{ display: 'inline-block' }}>
            <Scatter
                data={dataWithNoise}
                x={'x'}
                y={'y'}
                r={4}
                scaleX={{
                    variant: 'linear',
                    domain: [0, 'auto'],
                }}
                scaleY={{
                    variant: 'linear',
                    domain: [0, 'auto'],
                    nice: true,
                }}
            >
                <Axis variant={'bottom'} label={'x (a.u.)'} />
                <Axis variant={'left'} label={'y (a.u.)'} />
                <ScatterPoints
                    ids={['A']}
                    symbolStyle={{ fill: '#ffffff', stroke: '#333333', strokeWidth: 1 }}
                />
                <ScatterLabel
                    id={'A'}
                    position={0.5}
                    positionUnits={'relative'}
                    offset={[0, -60]}
                    style={{ textAnchor: 'end', fontWeight: 600 }}
                    children="Label"
                />
            </Scatter>
        </Chart>
    </Story>
</Canvas>

Prop `position` can also be given as a two-component array. In that case, `ScatterLabel` finds the nearest
data point to that position, and places the location there.

## Rotation

The label can be rotated with prop `angle`.
Alternatively, a prop `autoRotate` can compute a relevant rotation angle.

<Canvas>
    <Story
        name="manual angle"
        args={{
            id: 'quadratic',
            position: 6,
            positionUnits: 'view',
            offset: [0, -10],
            angle: -20,
            style: { textAnchor: 'end', fontWeight: 600 },
            children: 'manual',
        }}
        component={ScatterLabel}
        decorators={[ChartScatterQuadraticDecorator]}
    >
        {Template.bind({})}
    </Story>
    <Story
        name="auto rotation"
        args={{
            id: 'quadratic',
            position: 6,
            positionUnits: 'view',
            offset: [0, -10],
            autoRotate: true,
            style: { textAnchor: 'start', fontWeight: 600 },
            children: 'auto',
        }}
        component={ScatterLabel}
        decorators={[ChartScatterQuadraticDecorator]}
    >
        {Template.bind({})}
    </Story>
</Canvas>
